<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta http-equiv="Access-Control-Allow-Origin" content="*">
		<link href="css/iconfont.css" />
		<link href="css/mui.min.css" rel="stylesheet" />
		<script src="js/mui.min.js"></script>
		<script src="js/mui.picker.min.js"></script>
		<link href="css/icons-extra.css" rel="stylesheet" />
		<script type="text/javascript" src="js/iconfont.js"></script>
		<script type="text/javascript" src="js/jquery-1.8.2.min.js"></script>
		<style>
			.mui-slider-indicator .mui-indicator {
				background-color: #FFFFFF;
			}
			
			.mui-slider-indicator .mui-active.mui-indicator {
				background: #ff0000
			}
			
			.mui-bar-tab .mui-tab-item.mui-active {
				color: #ff0000
			}
			
			.mui-bar-tab .mui-tab-item {
				color: #EAEAEA
			}
			
			.mui-table-view-cell {
				list-style: none;
			}
			
			.mui-bar input[type=search] {
				height: 29px;
				margin: 6px 0;
				color: #fff;
				background-color: #FF1234;
			}
			
			body {
				background-color: #fbf7d2;
			}
			
			.mui-card-header {
				font-size: 9px;
				min-height: 8px;
				height: 10px;
				background-color: #f4e5be;
			}
			
			.mui-scroll-wrapper {
				position: fixed;
				top: 83px;
				height: 79%;
			}
			
			select option {
				text-align: center;
			}
			
			.mui-btn-block {
				text-align: center;
				padding: 0px;
			}
		</style>  
	</head>

	<body>

		<script type="text/javascript">
			mui.init()
		</script>
		<header class="mui-bar mui-bar-nav" style="background-color: #F0AD4E;">
			<a id="info" style="color: #999;"></a>
			<h1 class="mui-title">美食之家</h1>
		</header>

		<div class="mui-content" style="background-color: #fbf7d2;">

			<div id="tabbar" class="mui-control-content mui-active" style="background-color: #fbf7d2;">

				<!--轮播图开始-->
				<div id="slider" class="mui-slider">
					<div class="mui-slider-group mui-slider-loop">
						<!-- 第一张 -->
						<div class="mui-slider-item">
							<a href="#">
								<img src="images/c1.jpg" width="400px" height="150">
							</a>
						</div>
						<!-- 第一张 -->
						<div class="mui-slider-item">
							<a href="#">
								<img src="images/c2.jpg" width="400px" height="150">
							</a>
						</div>
						<!-- 第二张 -->
						<div class="mui-slider-item">
							<a href="#">
								<img src="images/c3.jpg" width="400px" height="150">
							</a>
						</div>
						<!-- 第三张 -->
						<div class="mui-slider-item">
							<a href="#">
								<img src="images/c4.jpg" width="400px" height="150">
							</a>
						</div>
						<!-- 第四张 -->
						<div class="mui-slider-item">
							<a href="#">
								<img src="images/c5.jpg" width="400px" height="150">
							</a>
						</div>
						<!-- 额外增加的一个节点(循环轮播：最后一个节点是第一张轮播) -->
						<div class="mui-slider-item mui-slider-item-duplicate">
							<a href="#">
								<img src="images/c1.jpg" width="400px" height="150">
							</a>
						</div>
					</div>
					<div class="mui-slider-indicator mui-text-right">
						<div class="mui-indicator mui-active"></div>
						<div class="mui-indicator"></div>
						<div class="mui-indicator"></div>
						<div class="mui-indicator"></div>
						<div class="mui-indicator"></div>
					</div>
				</div>
				<!--轮播图结束-->
				<!--卡片视图今日特价开始-->
				<div class="mui-card" style="background-color: #f4e5be;">
					<!--页眉，放置标题-->
					<div class="mui-card-header">今日特价</div>
					<!--内容区-->
					<div class="mui-card-content">
						<div align="center" style="display: inline;width: 100%; text-align: center;">
							<div class="mui-card" style="width: 26%;float: left;" onclick="findss(0)">
								<div class="mui-card-header">早餐专区</div>
								<div class="mui-card-content" style="padding: 3px;">
									<img src="images/z1.jpg" style="width: 100%;" />
								</div>
							</div>
							<div class="mui-card" style="width: 26%;float: left;" onclick="findss(1)">
								<div class="mui-card-header">午餐专区</div>
								<div class="mui-card-content" style="padding: 3px;">
									<img src="images/b4.jpg" style="width: 100%;" />
								</div>
							</div>
							<div class="mui-card" style="width: 26%;float: left;" onclick="findss(2)">
								<div class="mui-card-header">晚餐专区</div>
								<div class="mui-card-content" style="padding: 3px;">
									<img src="images/b5.jpg" style="width: 100%;" />
								</div>
							</div>
						</div>
					</div>
				</div>

				<!--卡片视图今日特价开始-->
				<div class="mui-card" style="background-color: #f4e5be;">
					<!--页眉，放置标题-->
					<div class="mui-card-header">精品推荐</div>
					<!--内容区-->
					<div class="mui-card-content">
						<ul class="mui-table-view" id="homedata">

						</ul>
					</div>
				</div>
			</div>

			<div id="tabbar-with-contact" class="mui-control-content" style="background-color: #fbf7d2; text-align: center;">
				<h3 style="margin-top: 50px;">登录</h3>
				<form class="mui-input-group" style="margin-top:100px;background-color: #f4e5be;">
					<div class="mui-input-row">
						<label>用户名</label>
						<input id="userName" type="text" class="mui-input-clear" placeholder="请输入用户名">
					</div>
					<div class="mui-input-row">
						<label>密码</label>
						<input id="pwd" type="password" class="mui-input-password" placeholder="请输入密码">
					</div>
					<div class="mui-button-row">
						<button type="button" onclick="login()" class="mui-btn mui-btn-primary">确认</button>
						<button type="button" class="mui-btn mui-btn-danger">取消</button>
					</div>
				</form>
			</div>
			<div id="tabbar-with-map" class="mui-control-content" style="background-color: #fbf7d2;">

			</div>
			<!--发现界面-->
			<div id="tabbar-with-find" class="mui-control-content" style="background-color: #fbf7d2;">
				<div align="center" style="text-align: center;margin-top:1px;">
					<select style="float: left; width: 34%; font-size: 10px;height:38px;" id="kind" onchange="initfind()">
						<option value="">全部分类</option>
						<option value="0">早餐</option>
						<option value="1">午餐</option>
						<option value="2">晚餐</option>
						<option value="3">甜点</option>
					</select>
					<select class="" style="float: left;width: 32%;font-size: 10px;height:38px;" id="price" onchange="initfind()">
						<option value="">综合排序</option>
						<option value="1">价格升序</option>
						<option value="0">价格降序</option>
					</select>
					<select class="" style="float: left;width: 34%;font-size: 10px;height:38px;" id="comment" onchange="initfind()">
						<option value="">评论排序</option>
						<option value="1">评论升序</option>
						<option value="0">评论降序</option>
					</select>
				</div>

				<div class="mui-scroll-wrapper">
					<div class="mui-scroll" id="finddata">

						<!--这里放置真实显示的DOM内容-->
					</div>
				</div>
			</div>

		</div>

		<nav id="navs" class="mui-bar mui-bar-tab" style="background-color: #F0AD4E;">
			<a id="home" class="mui-tab-item mui-active" href="#tabbar">
				<span class="mui-icon mui-icon-home"></span>
				<span class="mui-tab-label">首页</span>
			</a>

			<a id="find" class="mui-tab-item" href="#tabbar-with-find">
				<span class="mui-icon mui-icon-extra mui-icon-extra-find"></span>
				<span class="mui-tab-label">发现</span>
			</a>
			<a id="blog" class="mui-tab-item" href="#tabbar-with-map">
				<span class="mui-icon mui-icon-chatboxes"></span>
				<span class="mui-tab-label">博客</span>
			</a>
			<a id="me" class="mui-tab-item" href="#tabbar-with-contact">
				<span class="mui-icon mui-icon-contact"></span>
				<span class="mui-tab-label">我</span>
			</a>
		</nav>
		<input type="hidden" value="http://192.168.1.124:8033" id='hideurl' />

		<div id="sheet1" class="mui-popover mui-popover-bottom mui-popover-action ">
			<!-- 可选择菜单 -->
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<input id="Url" name="Url" type="text" class="mui-input-clear" placeholder="请输入服务器地址" data-input-clear="3"><span class="mui-icon mui-icon-clear mui-hidden"></span>
				</li>
			</ul>
			<!-- 取消菜单 -->
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<a href="#" onclick="setUrl()"><b>确定</b></a>
				</li>
			</ul>
		</div>

	</body>

	<script>
				var urls = localStorage.getItem("URLs");
				function setUrl() { 
					localStorage.setItem("URLs", "http://"+$("#Url").val());  
					mui('#sheet1').popover('toggle'); 
					window.location.reload();
				}
				$("#Url").val(urls);
				if(urls == null || urls=="") {
					mui('#sheet1').popover('toggle');
				}
				$("#hideurl").val(urls);
				//mui.toast("hide"+$("#hideurl").val());
		//打开数据库  
//			var db = openDatabase('contactdb', '', '', 204800);
//			db.transaction(function(tx) {
//			tx.executeSql('create table contact(id real,url text)', [], onSuccess, onError);
//			});
//			function cs123() {
//					tx.executeSql('insert into contact values(?,?)', ["1", "http://192.168.1.124:8033"], onSuccess, onError);
//				});
//			}
//			//sql语句执行成功后执行的回调函数  
//			function onSuccess(tx, rs) {
//				mui.toast("操作成功");
//			}
//			//sql语句执行失败后执行的回调函数  
//			function onError(tx, error) {
//				mui.toast("操作失败");
//			}
		window.addEventListener('swipeup', function(event) {
			mui('#sheet1').popover('toggle');
		});

		//获得slider插件对象
		var gallery = mui('.mui-slider');
		gallery.slider({
			interval: 5000 //自动轮播周期，若为0则不自动播放，默认为0；
		});

		mui('#navs').on('tap', '#find', function() {
			//$("#tabbar-with-find").append("cscs");
			$("#kind").val("");
			$("#finddata").load("find.html");
		})

		mui('#navs').on('tap', '#blog', function() {
			//$("#tabbar-with-find").append("cscs");
			$("#tabbar-with-map").load("blog.html");

		})

		mui('.mui-scroll-wrapper').scroll({
			deceleration: 0.0005 //flick 减速系数，系数越大，滚动速度越慢，滚动距离越小，默认值0.0006
		});

		function cs(id) {
			window.location.href = "findDetails.html?id=" + id;
		}

		function findss(num) {
			window.location.href = "find2.html?id=" + num;
		}

		//初始化首页数据
		function init() {

			$.ajax($("#hideurl").val() + '/tp/Cookery/Index/indexForApp', {
				dataType: 'json', //服务器返回json格式数据
				type: 'post', //HTTP请求类型
				timeout: 10000, //超时时间设置为10秒；  
				async:true,
				success: function(data) {    
					//服务器返回响应，根据响应结果，分析是否登录成功；
					$("#homedata").empty();
					var str = "";
					$.each(data, function(i) {
						str = str +
							'<li class="mui-table-view-cell mui-media">' +
							'<a href="#" onclick="cs(' + data[i].ID + ')">' +
							'<img class="mui-media-object mui-pull-left" src="'+$("#hideurl").val() +"/"+ data[i].PicUrl + '">' +
							'<div class="mui-media-body">' +
							data[i].Name +
							'<p class="mui-ellipsis">' + data[i].briefIntroduction + '</p>' +
							'</div>' +
							'</a>' +
							'</li>';

					});
					$("#homedata").append(str);
				},
				error: function(data) {
					//异常处理；
				}
			});

		}
		init();

		function login() {
			$.ajax($("#hideurl").val() + '/tp/CookeryManageSystem/Index/login', {
				data: {
					userName: $("#userName").val(),
					passWord: $("#pwd").val()
				},
				dataType: 'json', //服务器返回json格式数据
				type: 'post', //HTTP请求类型
				timeout: 10000, //超时时间设置为10秒；
				async:true,
				success: function(data) {
					if(data == "成功!!!") {
						var urls = localStorage.getItem("URLs");
						window.location.href = urls+"/tp/CookeryManageSystem/Admin/index";
					}
				},
				error: function(data) {
					//异常处理；
				}
			});
		}
	</script>

</html>